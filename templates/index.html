<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fileigloo</title>

    <link rel="preload" href="/public/pcss-1.1.2.min.css" as="style">

    <link rel="icon" href="/public/favicon.png">
    <link rel="stylesheet" href="/public/pcss-1.1.2.min.css">

    <style>
        .hidden {
            display: none !important;
        }
        #file-select {
            display: block;
            background: #161f27;
            border-radius: 6px;
            color: #dbdbdb;
            cursor: pointer;
            margin-bottom: 8px;
        }
        #file-select-input {
            display: none;
        }
        #file-select #file-select-filename {
            display: inline-block;
            padding-left: 12px;
        }
        #file-select #file-select-button {
            display: inline-block;
            padding: 10px 14px;
            background: #1a242f;
        }
        #file-select:hover #file-select-button {
            background: #324759;
            transition: all 0.2s ease-in-out;
	        -moz-transition: all 0.2s ease-in-out;
	        -webkit-transition: all 0.2s ease-in-out;
	        -o-transition: all 0.2s ease-in-out;
        }
        #pastebin-input {
            font-family: monospace;
        }
        @keyframes spinner-inner {
            0% { transform: translate(-50%,-50%) rotate(0deg); }
            100% { transform: translate(-50%,-50%) rotate(360deg); }
        }
        .spinner-outer {
            width: 32px;
            height: 26px;
            display: inline-block;
            overflow: hidden;
        }
        .spinner-inner {
            transform: translateZ(0) scale(0.3);
            backface-visibility: hidden;
            transform-origin: 0 0;
        }
        .spinner-inner div {
            box-sizing: content-box; 

            position: absolute;
            width: 62px;
            height: 62px;
            border: 8px solid #4ea7ff;
            border-top-color: transparent;
            border-radius: 50%;

            animation: spinner-inner 3s linear infinite;
            top: 44px;
            left: 44px;
        }
    </style>
</head>

<body>
    <main>
        <center>
            <a href="/">
                <img src="/public/logo-transparent-white.svg" width="84" />
            </a>
        </center>

        {{ if .fileUrl }}
        <div id="result">
            <fieldset>
                <legend>Result</legend>
                <center>
                    File uploaded: <a href="{{ .fileUrl }}">{{ .fileUrl }}</a>
                </center>
            </fieldset>
        </div>
        {{ end }}

        <form id="form" method="POST" action="/" enctype="multipart/form-data">
            <section>
                <fieldset>
                    <legend>File Upload</legend>
                    <div id="file-select">
                        <div id="file-select-button">Choose File</div>
                        <div id="file-select-filename">No file chosen...</div>
                        <input id="file-select-input" type="file" name="file" />
                    </div>
                    <button id="file-upload-button" type="submit">Upload</button>
                    <div id="spinner" class="spinner-outer hidden"><div class="spinner-inner"><div></div></div></div>
                </fieldset>
            </section>

            <section id="pastebin">
                <fieldset>
                    <legend>Pastebin</legend>
                    <textarea id="pastebin-input" autocomplete="off" rows="24" name="text"></textarea>
                    <button id="pastebin-button" type="submit">Create</button>
                </fieldset>
            </section>
        </form>

        <footer>
            Copyright (c) {{ now.UTC.Year }} by Kamil Marut |
            <a href="https://github.com/exler/fileigloo" target="_blank" rel="noopener noreferrer">Github</a>
        </footer>
    </main>
    <script>
        window.onload = function() {
            let fileSelect = document.getElementById("file-select");
            let fileInput = document.getElementById("file-select-input");
            let fileUploadButton = document.getElementById("file-upload-button");
            let selectFilename = document.getElementById("file-select-filename");
            fileSelect.onclick = function() { fileInput.click(); };
            fileSelect.ondragover = function(event) { event.stopPropagation(); event.preventDefault(); };
            fileSelect.ondrop = function(event) { 
                event.stopPropagation(); 
                event.preventDefault(); 
                fileInput.files = event.dataTransfer.files; 
                selectFilename.innerHTML = fileInput.files[0].name;
            };
            fileInput.onchange = function() {
                let file = fileInput.files[0];
                selectFilename.innerHTML = file.name;
            };
            fileUploadButton.onclick = function() {
                if (fileInput.files.length != 0) {
                    document.getElementById("spinner").classList.remove("hidden");
                }
            };
        }
    </script>
</body>

</html>
